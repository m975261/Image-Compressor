Context
The project already has:

An Admin Temp Drive protected by password + Google Authenticator

A Share Drive feature that generates a password-protected link

This prompt is to change and harden the Share Drive behavior, not rewrite the feature.

ğŸ¯ Required Change (Core Logic)
ğŸ”„ Current behavior (to be changed)

Share Drive exposes the adminâ€™s main drive content

âœ… New required behavior

When admin enables Share Drive, it must:

Create a new, separate folder

Folder starts EMPTY

Folder is NOT linked to adminâ€™s personal drive

Each share link maps to its own isolated folder

Admin drive = personal/private
Shared drive = isolated temporary space

ğŸ“‚ Drive Structure Rules

Admin Drive

Accessed only via admin password + OTP

Contains adminâ€™s personal files

Admin can:

Upload

Download

Delete

See blocked IPs

Shared Drive

Created per share enable action

Starts empty

Accessible only via:

Share link

Share password

Users can:

Upload files

Download files

Users CANNOT:

Delete files

See admin files

Enable/disable sharing

See other shared drives

ğŸ” Authentication & Security (Expanded)
Password Failure Protection (GLOBAL)

For ALL entry points:

Admin login

Share Drive access

Rule:

If password is entered wrong 3 times from the same IP:

Block the IP for 2 days

Block applies to:

Admin login

Shared drive access

Blocking must be server-side

IP Block Management (Admin Only)

Inside Admin Temp Drive, add a sub-tab:

Blocked IPs

Admin can:

View blocked IP list

See:

IP address

Reason (admin login / share drive)

Block expiry time

Manually unblock IPs

ğŸ”— Share Drive Lifecycle (UPDATED)
When Admin clicks Share Drive

Prompt for:

Share password

Expiry time (default 5 minutes)

On apply:

Create:

New folder

New share ID

New access token

Associate:

Folder â†â†’ share link

Folder â†â†’ share password (hashed)

Display:

Share link

Copy icon

When User accesses Share Link

Prompt for share password

Apply IP blocking rules

If password correct:

Grant access to that specific shared folder

Allow:

Upload

Download

Deny:

Delete

Admin controls

Other folders

When Share Expires or Admin Disables

Shared drive becomes inaccessible

Folder is:

Either deleted

Or archived (developer choice)

Share token invalidated

System returns to default state

ğŸ›¡ï¸ Security Constraints (NON-NEGOTIABLE)

Admin files never exposed to shared users

Each share = unique folder

Passwords:

Hashed

Never stored plaintext

IP blocking enforced before authentication

No client-side enforcement of permissions

No shared users can delete files

ğŸ§ª Acceptance Criteria

The change is correct only if:

âœ… Admin drive and shared drives are fully isolated
âœ… Each share link creates a new empty folder
âœ… Shared users never see admin files
âœ… Shared users can upload & download only
âœ… 3 failed password attempts block IP for 2 days
âœ… IP blocking applies to admin & shared access
âœ… Admin can view and manage blocked IPs
âœ… Admin controls sharing lifecycle
âœ… No regressions to existing Temp Drive logic

ğŸ“¦ Deliverables

Modify Share Drive logic to use isolated folders

Add IP blocking logic (3 attempts â†’ 2 days)

Add Blocked IPs sub-tab for admin

Update permission checks

Brief explanation of changes made

ğŸ” One-Line Summary

Change Share Drive so each share creates an isolated empty folder, enforce IP blocking after 3 failed attempts, and allow admin to manage blocked IPs from within their personal Temp Drive.